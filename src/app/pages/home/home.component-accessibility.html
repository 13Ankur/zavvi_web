<div class="home-page" role="main">
  <!-- Banner Slider -->
  <section class="banner-section" 
           *ngIf="bannerShops.length > 0 && !isLoading"
           aria-label="Featured Shops Banner">
    <div class="banner-slider">
      <div class="banner-slide" 
           *ngFor="let shop of bannerShops; let i = index" 
           [class.active]="i === currentSlideIndex"
           role="group"
           [attr.aria-label]="'Slide ' + (i + 1) + ' of ' + bannerShops.length">
        <img [src]="shop.image" 
             [alt]="shop.title + ' banner image'"
             (error)="onImageError($event, shop)">
        <div class="banner-overlay">
          <div class="banner-content">
            <h1 class="shop-title-banner">{{ shop.title || 'Featured Shop' }}</h1>
            <p *ngIf="shop.discount" class="discount" aria-label="Discount offer">
              {{ shop.discount }}
            </p>
            <button class="banner-btn" 
                    (click)="navigateToOffer(shop.id)"
                    [attr.aria-label]="'View details for ' + shop.title">
              View Details
            </button>
          </div>
        </div>
      </div>
    </div>
    <!-- Banner Navigation Dots -->
    <div class="banner-dots" *ngIf="bannerShops.length > 1" role="tablist" aria-label="Banner slides">
      <button *ngFor="let shop of bannerShops; let i = index"
              class="dot"
              [class.active]="i === currentSlideIndex"
              (click)="goToSlide(i)"
              [attr.aria-label]="'Go to slide ' + (i + 1)"
              [attr.aria-selected]="i === currentSlideIndex"
              role="tab"></button>
    </div>
  </section>

  <!-- Main Content -->
  <div class="main-content">

    <!-- Categories Section -->
    <section class="categories-section" 
             *ngIf="categories.length > 0 && !isLoading"
             aria-labelledby="categories-title">
      <h2 id="categories-title" class="section-title">Browse Categories</h2>
      <div class="categories-grid" role="list">
        <div class="category-card" 
             *ngFor="let category of categories"
             role="listitem"
             [attr.tabindex]="0"
             (click)="navigateToCategory(category.slug || category._id)"
             (keydown.enter)="navigateToCategory(category.slug || category._id)"
             (keydown.space)="navigateToCategory(category.slug || category._id)"
             (mouseenter)="onCategoryHover(category.slug || category._id)"
             (mouseleave)="onCategoryLeave(category.slug || category._id)"
             [attr.aria-label]="'Browse ' + category.name + ' category'">
          <div class="category-icon-wrapper" aria-hidden="true">
            <svg class="category-icon" viewBox="0 0 512 512" fill="currentColor">
              <use [attr.href]="'#icon-' + (category.icon || 'ellipse-outline')"></use>
            </svg>
            <div class="category-emoji">{{ getCategoryIcon(category.icon) }}</div>
          </div>
          <h3>{{ category.name || 'Category' }}</h3>
        </div>
      </div>
    </section>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-state" role="status" aria-live="polite">
      <div class="spinner" aria-hidden="true"></div>
      <p>Loading offers...</p>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage && !isLoading" 
         class="error-message" 
         role="alert" 
         aria-live="assertive">
      <p>{{ errorMessage }}</p>
      <button class="retry-btn" (click)="retryLoading()">Retry</button>
    </div>

    <!-- Offers Grid -->
    <section class="offers-section" 
             *ngIf="!isLoading && allOffers.length > 0"
             aria-labelledby="offers-title">
      <h2 id="offers-title" class="section-title">
        {{ searchTerm ? 'Search Results' : 'Featured Offers' }}
      </h2>
      
      <div class="offers-grid" role="list">
        <article class="offer-card" 
                 *ngFor="let offer of allOffers"
                 role="listitem"
                 [attr.tabindex]="0"
                 (click)="navigateToOffer(offer.id)"
                 (keydown.enter)="navigateToOffer(offer.id)"
                 (keydown.space)="navigateToOffer(offer.id)"
                 [attr.aria-label]="offer.title + (offer.discount ? ', ' + offer.discount + ' discount' : '')">
          <div class="offer-image">
            <img [src]="offer.image || offer.logo" 
                 [alt]="offer.title + ' logo'"
                 (error)="onImageError($event, offer)"
                 loading="lazy">
            <span class="discount-badge" 
                  *ngIf="offer.discount"
                  aria-label="Discount">
              {{ offer.discount }}
            </span>
          </div>
          <div class="offer-content">
            <h3 class="offer-title">{{ offer.title || 'Offer' }}</h3>
            <p class="category-name" *ngIf="offer.category">
              {{ offer.category.name || offer.category }}
            </p>
            <p class="offer-location" *ngIf="offer.location">
              üìç {{ offer.location }}
            </p>
          </div>
        </article>
      </div>
    </section>

    <!-- No Offers -->
    <div *ngIf="!isLoading && allOffers.length === 0 && !errorMessage" 
         class="no-offers"
         role="status">
      <svg class="no-offers-icon" xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      <p>No offers available{{ selectedLocation ? ' for ' + selectedLocation.name : '' }}.</p>
      <p class="hint">Try changing your location or search term.</p>
    </div>
  </div>
</div>

<!-- SVG Icon Definitions (hidden) -->
<svg style="display: none;" aria-hidden="true">
  <defs>
    <symbol id="icon-restaurant" viewBox="0 0 512 512">
      <path d="M357.57 223.94a79.48 79.48 0 0056.58-23.44l77-76.95c6.09-6.09 6.65-16 .85-22.39a16 16 0 00-23.17-.56l-68.63 68.58a12.29 12.29 0 01-17.37 0c-4.79-4.78-4.53-12.86.25-17.64l68.33-68.33a16 16 0 00-.56-23.16A15.62 15.62 0 00440.27 56a16.71 16.71 0 00-11.81 4.9l-68.27 68.26a12.29 12.29 0 01-17.37 0c-4.78-4.78-4.53-12.86.25-17.64l68.33-68.33a16 16 0 00-.56-23.16A15.62 15.62 0 00400.26 16a16.73 16.73 0 00-11.81 4.9L311.5 97.85a79.49 79.49 0 00-23.44 56.59v8.23a16 16 0 01-4.69 11.33l-35.61 35.62a4 4 0 01-5.66 0L68.82 36.33a16 16 0 00-22.58 0C31.09 51.28 23 72.47 23 97.54c-.1 41.4 21.66 89 56.79 124.08l85.45 85.45A64.79 64.79 0 00211 326a64 64 0 0016.21-2.08 16.24 16.24 0 014.07-.53 15.93 15.93 0 0110.83 4.25l11.39 10.52a16.12 16.12 0 014.6 11.23v5.54a47.73 47.73 0 0013.77 33.65l90.5 91.11a16 16 0 0022.63 0l90.49-90.5a16 16 0 000-22.63l-91.11-90.5a47.73 47.73 0 00-33.65-13.77h-3.87a16 16 0 01-10.58-3.94l-10.34-9.16a15.93 15.93 0 01-5.36-11.94 16.27 16.27 0 01.53-4.07 64 64 0 002.08-16.21 64.79 64.79 0 00-18.93-45.77L176.63 86.38a4 4 0 010-5.65l35.46-35.46a16 16 0 0011.31-4.69z"/>
    </symbol>
    <symbol id="icon-fitness" viewBox="0 0 512 512">
      <path d="M467 176a29.94 29.94 0 00-25.32 13.88L427.73 64l-48-16-48 16V48h-32v80h-98V48h-32v16l-48-16-48 16 13.95 125.88A29.94 29.94 0 0071 176a30 30 0 00-30 30v30a30 30 0 0030 30 29.94 29.94 0 0025.32-13.88l36.72-51.89L146 304H128v32h64v-80h128v80h64v-32h-18l12.96-103.77 36.72 51.89A29.94 29.94 0 00441 236a30 30 0 0030-30v-30a30 30 0 00-30-30z"/>
    </symbol>
    <symbol id="icon-ellipse-outline" viewBox="0 0 512 512">
      <circle cx="256" cy="256" r="192" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
    </symbol>
  </defs>
</svg>

